<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kuis</title>
<style>
body{
  margin:0;
  padding:0;
  font-family:"Poppins",sans-serif;
  background:linear-gradient(135deg,#7da1ea,#6b98f3);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.progress-bar{
  position:absolute;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  width:300px;
  height:10px;
  background:#ddd;
  border-radius:5px;
  overflow:hidden;
}
.progress-fill{
  height:100%;
  background:#6b98f3;
  width:0%;
  transition:width 0.3s;
}
.card{
  background:white;
  padding:25px;
  border-radius:15px;
  box-shadow:0 4px 10px rgba(0,0,0,0.2);
  text-align:center;
  width:320px;
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  display:none;
  transition:transform 0.3s;
}
.card.active{
  display:block;
}
input,button,a.mbti-link{
  display:block;
  width:90%;
  padding:10px;
  margin:8px auto;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:14px;
  text-align:center;
  text-decoration:none;
}
button{
  background:#6b98f3;
  border:none;
  color:white;
  cursor:pointer;
  font-size:15px;
  transition:background 0.3s;
}
button:hover{background:#4981f1;}
a.mbti-link{
  color:#6b98f3;
  font-size:13px;
}
a.mbti-link:hover{text-decoration:underline;}
</style>
</head>
<body>

<div class="progress-bar">
  <div class="progress-fill" id="progressFill"></div>
</div>

<div class="card active" id="loginCard">
<h2>Masukin Data Kamu</h2>
<input type="text" id="nama" placeholder="Nama" required>
<input type="text" id="kelas" placeholder="Kelas" required>
<input type="password" id="password" placeholder="Password" required>
<button onclick="checkForm()">Lanjutkan</button>
</div>

<div class="card" id="step1">
<h2>Zodiak Kamu?</h2>
<input type="text" id="zodiak" placeholder="Zodiak" required>
<button onclick="nextStep()">Next</button>
</div>

<div class="card" id="step2">
<h2>Game Favorit Kamu?</h2>
<input type="text" id="game" placeholder="Game Favorit" value="dinasaurus" required>
<button onclick="nextStep()">Next</button>
</div>

<div class="card" id="step3">
<h2>MBTI Kamu?</h2>
<input type="text" id="mbti" placeholder="MBTI" required>
<a href="https://psikologila.id/tes-kepribadian-mbti/" target="_blank" class="mbti-link">Ayo test MBTI dulu</a>
<button onclick="nextStep()">Next</button>
</div>

<div class="card" id="step4">
<h2>Person Favorit Kamu?</h2>
<input type="text" id="person" placeholder="Person Favorit" required>
<button onclick="submitKuis()">Submit</button>
</div>

  <div class="card" id="surpriseCard">
<h2>Data Berhasil Tersimpan</h2>
<p id="ucapan"></p>
<div id="userData" style="display:none;"></div>
<a href="https://open.spotify.com/playlist/4QEIx6IiWJn4rgp6HBxmO5?si=U6-7zgJ3Qmi0qG2Z8a5wvQ&pt=b24dc855d8bc7ecb53c383b8dbba4704&pi=rKTxm_izQ5WdS" target="_blank">ðŸŽµ Link Spotify</a><br><br>
<a href="https://docs.google.com/document/d/1QbIMwCccKvL3kqmSHlQ1kJf4PB76aW8T337oYSEVaGA/edit?usp=drivesdk" target="_blank">ðŸ“‚ Link Google Drive</a><br><br>
<button onclick="bukaFile()">Klik Di sini</button><br><br>
<button id="lihatDataBtn" onclick="lihatData()" style="display:none;">Lihat Data</button>
</div>

<div class="card" id="dataCard">
<h2>Data Teman-Teman</h2>
<div id="dataList"></div>
<button onclick="kembali()">Kembali</button>
</div>

<script>
let currentStep=0;
const steps=["loginCard","step1","step2","step3","step4"];
const GAS_URL = "https://script.google.com/macros/s/AKfycbz3p2Md7uF4Bql7lhf-an9yKNwbNcFGDwGt911AQ1l6HdpNiMezu5wwQtBwi9tKYRM/exec"; 

function updateProgress(){
  const progress = (currentStep / (steps.length - 1)) * 100; 
  document.getElementById("progressFill").style.width = progress + "%";
}

function nextStep(){
  const currentDiv=document.getElementById(steps[currentStep]);
  const input=currentDiv.querySelector("input");
  if(input && input.value.trim()===""){alert("Isi dulu sebelum lanjut!"); return;}
  currentDiv.classList.remove("active");
  currentStep++;
  updateProgress();
  document.getElementById(steps[currentStep]).classList.add("active");
}

const WEBMASTER_PASSWORD = "admin123";

function submitKuis(){
  const inputs=["nama","kelas","password","zodiak","game","mbti","person"];
  for(let id of inputs){
    if(document.getElementById(id).value.trim()===""){alert("Isi semua dulu sebelum submit!"); return;}
  }
  const data={};
  for(let id of inputs) data[id]=document.getElementById(id).value.trim();

  console.log("Sending data to Google Apps Script:", data);

  // Send data to Google Apps Script Web App
  fetch(GAS_URL, {
    method: "POST",
    mode: "no-cors",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(data)
  }).then(() => {
    updateProgress(); // Set to 100%
    document.getElementById(steps[currentStep]).classList.remove("active");
    document.getElementById("surpriseCard").classList.add("active");
    document.getElementById("ucapan").innerText = "Klik Link Di Bawah!";

    if(data.password === WEBMASTER_PASSWORD){
      document.getElementById("userData").style.display = "block";
      document.getElementById("lihatDataBtn").style.display = "block";
      document.getElementById("userData").innerHTML = `<p><strong>Data Kamu:</strong></p><p>Nama: ${data.nama}</p><p>Kelas: ${data.kelas}</p><p>Zodiak: ${data.zodiak}</p><p>Game: ${data.game}</p><p>MBTI: ${data.mbti}</p><p>Person: ${data.person}</p>`;
    } else {
      document.getElementById("userData").style.display = "none";
      document.getElementById("lihatDataBtn").style.display = "none";
      document.getElementById("userData").innerHTML = "";
    }
  }).catch((error) => {
    alert("Gagal mengirim data. Silakan coba lagi.");
    console.error("Error sending data:", error);
  });
}

function checkForm(){
  const nama=document.getElementById("nama").value.trim();
  const kelas=document.getElementById("kelas").value.trim();
  const password=document.getElementById("password").value.trim();
  if(nama===""||kelas===""||password===""){alert("Wajib Di isi!"); return;}
  nextStep();
}

function bukaFile() {
  window.location.href = "index.html";
}

function lihatData(){
  alert("Data teman hanya dapat dilihat oleh pembuat web melalui Google Sheet.");

  return;
}

function kembali(){
  document.getElementById("dataCard").classList.remove("active");
  document.getElementById("surpriseCard").classList.add("active");
}
</script>


</script>

</body>
</html>
